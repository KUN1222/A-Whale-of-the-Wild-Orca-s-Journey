<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Whale of the Wild - Family Tree</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 严格遵守设计规范：深色背景，浅色文字 */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap');
        :root {
            --bg-dark: #0a192f;
            --bg-node: #112240;
            --border-line: #233554;
            --text-light: #ccd6f6;
            --text-medium: #8892b0;
            --text-accent: #64ffda;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-light);
            padding: 2rem;
        }
        .tree-wrapper {
            display: flex;
            justify-content: center;
            overflow-x: auto;
            padding: 2rem 0;
        }
        .tree ul, .tree li {
            position: relative;
            margin: 0;
            padding: 0;
            list-style-type: none;
        }
        .tree ul {
            display: flex;
            /* 增加代际间距 */
            padding-top: 70px; 
        }
        .tree li {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0 10px;
        }
        .node {
            padding: 12px 24px;
            background-color: var(--bg-node);
            border: 1px solid var(--border-line);
            border-radius: 6px;
            font-weight: 500;
            text-align: center;
            min-width: 140px;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }
        .node-icon {
            font-size: 1.5rem;
            line-height: 1;
        }
        .node:hover {
            transform: translateY(-3px);
            border-color: var(--text-accent);
        }
        .node.is-vega {
            color: var(--text-accent);
            border-color: var(--text-accent);
            box-shadow: 0 0 15px rgba(100, 255, 218, 0.2);
        }
        .node.is-lost {
            color: var(--text-medium);
            text-decoration: line-through;
            opacity: 0.7;
        }
        /* 修正并加长连接线 */
        .tree li::before {
            content: '';
            position: absolute;
            top: -35px; /* 增加长度 */
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 35px; /* 增加长度 */
            background-color: var(--border-line);
        }
        .tree li::after {
            content: '';
            position: absolute;
            top: -35px; /* 匹配垂直线位置 */
            height: 2px;
            background-color: var(--border-line);
            width: 100%;
        }
        .tree > li::before, .tree > li::after { display: none; }
        .tree ul li:only-child::after { display: none; }
        .tree ul li:first-child::after { left: 50%; width: 50%; }
        .tree ul li:last-child::after { left: 0; width: 50%; }
        .relationship-label {
            position: absolute;
            top: -55px; /* 调整位置以适应更长的线 */
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.75rem;
            color: var(--text-medium);
            background-color: var(--bg-dark);
            padding: 0 5px;
            white-space: nowrap;
        }
        .section-title {
            text-align: center;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-accent);
            margin-top: 4rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border-line);
        }
        /* 模态框样式 */
        .modal-backdrop {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-color: rgba(10, 25, 47, 0.85);
            backdrop-filter: blur(5px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 50;
        }
        .modal-content {
            background-color: var(--bg-node);
            border: 1px solid var(--text-accent);
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            padding: 2rem;
            position: relative;
        }
        .modal-icon {
            font-size: 3rem;
            float: left;
            margin-right: 1rem;
            margin-top: 0.5rem;
        }
    </style>
</head>
<body>
    <header class="text-center mb-4">
        <h1 class="text-3xl md:text-5xl font-bold">The Whale of the Wild</h1>
        <p class="text-lg text-cyan-400">核心家族关系图</p>
    </header>

    <div id="tree-container" class="tree-wrapper">
        <!-- JS 生成族谱 -->
    </div>
    
    <div id="other-kinship-container">
        <h2 class="section-title">同族其他成员</h2>
        <div class="tree-wrapper">
             <!-- JS 生成其他成员 -->
        </div>
    </div>

    <!-- 模态框 HTML -->
    <div id="character-modal" class="modal-backdrop">
        <div class="modal-content">
            <button id="close-modal" class="absolute top-4 right-4 text-gray-400 hover:text-white text-2xl font-bold">&times;</button>
            <div id="modal-body"></div>
        </div>
    </div>

    <script>
        const characterData = {
            siria: { name: 'Greatmother Siria', icon: '👵🏻', title: '智慧的女族长', story: '家族的最高领袖与首席寻路者。她是整个鲸群的智慧核心与历史的活字典。她的教诲，如“美是思想的食粮”，在维加最迷茫的时候给予了关键指引。' },
            arctura: { name: 'Mother Arctura', icon: '👩🏻', title: '慈爱的猎手', story: '维加和德内伯的母亲，一位强大的猎手。她在承受丧女之痛的同时，依然是孩子们心中温暖和力量的来源。' },
            nova: { name: 'Aunt Nova', icon: '👩🏻', title: '支持的姐妹', story: '阿克图拉的姐妹，阿奎拉的母亲。她在家族中扮演着重要的情感支持角色，体现了母系社会中姐妹间的紧密联系。' },
            andromeda: { name: 'Andromeda', icon: '👧🏻', title: '失落的亲人', isLost: true, story: '阿克图拉和诺娃最小的妹妹，在多年前的“捕猎季”被人类抓走，她的失踪是家族心中永远的痛。' },
            rigel: { name: 'Great-uncle Rigel', icon: '👨🏻‍🦳', title: '坚定的守护者', story: '希莉亚的弟弟，家族的守护神。他沉默寡言但行动充满力量，背上的伤疤见证了他为保护家族而战的英勇过去。' },
            antares: { name: 'Great-uncle Antares', icon: '👨🏻‍🦳', title: '警惕的守护者', story: '与参宿七一同行动的守护者，很可能是希莉亚老祖母的另一位兄弟。他在家族需要保护的关键时刻总是挺身而出。' },
            vega: { name: 'Vega', icon: '👧🏻', title: '成长中的寻路者', isProtagonist: true, story: '故事的主角。在经历失去妹妹、与家族失散的重重考验后，她从一个冲动、迷茫的年轻虎鲸，成长为一名勇敢、有担当的真正领袖。' },
            deneb: { name: 'Deneb', icon: '👦🏻', title: '忠诚的追随者', story: '维加的弟弟。他对姐姐怀有绝对的信任，是维加力量的重要来源。他在旅途中从一个需要被保护的孩子，成长为一个勇敢的少年。' },
            aquila: { name: 'Aquila', icon: '👩🏻', title: '坚强的母亲', story: '维加的表姐。她从一个处处表现优越的“模范生”，在灾难和饥饿的打击下，蜕变为一个为了孩子可以放弃一切的母亲。' },
            capella: { name: 'Capella', icon: '🖤', title: '陨落的希望', isLost: true, story: '维加未曾谋面的妹妹，出生即夭折。她的死亡是维加离家和最终成长的直接原因。' },
            altair: { name: 'Altair', icon: '👦🏻', title: '天真的幼鲸', story: '阿奎拉的幼子，代表了鲸群的未来与希望。在艰难的旅途中，他的存在是大家继续前行的动力之一。' },
            io: { name: 'Io (Ancestor)', icon: '📜', title: '先祖', story: '“暖水食鲑社群”的一位祖先，在“大集会”时被提及，是 Ganymede 的曾祖母。' },
            europa: { name: 'Europa', icon: '👩🏻', title: '同族成员', story: 'Io 的后代，Ganymede 的母亲，属于庞大的“暖水食鲑社群”。' },
            ganymede: { name: 'Ganymede', icon: '👧🏻', title: '同族成员', story: 'Europa 的女儿，在“大集会”时向大家宣告自己的名字和血统。' },
            titania: { name: 'Titania (Ancestor)', icon: '📜', title: '先祖', story: '“暖水食鲑社群”的另一位祖先，是 Mimas 的曾祖母。' },
            phoebe: { name: 'Phoebe', icon: '👩🏻', title: '同族成员', story: 'Titania 的女儿，Mimas 的母亲。' },
            mimas: { name: 'Mimas', icon: '👦🏻', title: '同族成员', story: 'Phoebe 的儿子，在“大集会”时宣告自己的名字。' }
        };

        function createNode(id) {
            const char = characterData[id];
            const node = document.createElement('div');
            node.className = 'node';
            node.dataset.id = id;
            if (char.isProtagonist) node.classList.add('is-vega');
            if (char.isLost) node.classList.add('is-lost');
            
            const iconSpan = document.createElement('span');
            iconSpan.className = 'node-icon';
            iconSpan.textContent = char.icon;

            const nameSpan = document.createElement('span');
            nameSpan.textContent = char.name;

            node.appendChild(iconSpan);
            node.appendChild(nameSpan);

            return node;
        }

        function createTreeHTML(structure) {
            const li = document.createElement('li');
            
            if (structure.label) {
                const label = document.createElement('span');
                label.className = 'relationship-label';
                label.textContent = structure.label;
                li.appendChild(label);
            }

            li.appendChild(createNode(structure.id));

            if (structure.children && structure.children.length > 0) {
                const ul = document.createElement('ul');
                structure.children.forEach(child => ul.appendChild(createTreeHTML(child)));
                li.appendChild(ul);
            }
            return li;
        }

        // --- 主家族结构 ---
        const mainFamilyTreeStructure = {
            id: 'siria',
            children: [
                { id: 'arctura', label: '女儿', children: [
                    { id: 'vega', label: '女儿' },
                    { id: 'deneb', label: '儿子' },
                    { id: 'capella', label: '女儿' }
                ]},
                { id: 'nova', label: '女儿', children: [
                    { id: 'aquila', label: '女儿', children: [
                        { id: 'altair', label: '儿子' }
                    ]}
                ]},
                { id: 'andromeda', label: '女儿' },
                { id: 'rigel', label: '弟弟' },
                { id: 'antares', label: '弟弟' }
            ]
        };
        const mainTreeUl = document.createElement('ul');
        mainTreeUl.className = 'tree';
        mainTreeUl.appendChild(createTreeHTML(mainFamilyTreeStructure));
        document.getElementById('tree-container').appendChild(mainTreeUl);

        // --- 其他成员结构 ---
        const otherKinshipContainer = document.querySelector('#other-kinship-container .tree-wrapper');
        const ioTree = createTreeHTML({ id: 'io', children: [{ id: 'europa', label: '后代', children: [{ id: 'ganymede', label: '女儿' }] }] });
        const titaniaTree = createTreeHTML({ id: 'titania', children: [{ id: 'phoebe', label: '女儿', children: [{ id: 'mimas', label: '儿子' }] }] });
        const ioTreeUl = document.createElement('ul');
        ioTreeUl.className = 'tree';
        ioTreeUl.appendChild(ioTree);
        const titaniaTreeUl = document.createElement('ul');
        titaniaTreeUl.className = 'tree ml-16';
        titaniaTreeUl.appendChild(titaniaTree);
        otherKinshipContainer.append(ioTreeUl, titaniaTreeUl);

        // --- Modal Logic ---
        const modal = document.getElementById('character-modal');
        const modalBody = document.getElementById('modal-body');
        const closeModalBtn = document.getElementById('close-modal');

        document.querySelectorAll('.node').forEach(node => {
            node.addEventListener('click', () => {
                const id = node.dataset.id;
                const char = characterData[id];
                modalBody.innerHTML = `
                    <div class="modal-icon">${char.icon}</div>
                    <div>
                        <h2 class="text-2xl font-bold ${char.isProtagonist ? 'text-cyan-400' : ''}">${char.name}</h2>
                        <p class="text-sm text-gray-400 mb-4">${char.title}</p>
                        <p>${char.story}</p>
                    </div>
                `;
                modal.style.display = 'flex';
            });
        });

        closeModalBtn.addEventListener('click', () => { modal.style.display = 'none'; });
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                modal.style.display = 'none';
            }
        });
    </script>
</body>
</html>

